<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"><html>

<head>
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0">  
  <script type="text/javascript">
    function onLoad() {
      if(window.flutterWebview != undefined) {
        flutterWebview.onmessage = function(event) {
  // prints "Got it!" when we receive the app's response.
          alert("onmessage:" + event.data);
}
      }
    }
    
    function test() {
      if(window.flutterWebview != undefined) {
        flutterWebview.postMessage("haha");
      }
    }
    
    function test2() {
      if(window.flutterWebview != undefined) {
        var imageUrl = "https://kenshinn.github.io/Test/cast01.png";
        fetch(imageUrl)
  .then((response) => response.blob())
  .then((myBlob) => {
    flutterWebview.postMessage({feature:'blob', data:myBlob});    
  });        
      }      
    }
    
function test3() {
      if(window.flutterWebview != undefined) {
        var imageUrl = "https://kenshinn.github.io/Test/cast01.png";
        fetch(imageUrl)
  .then((response) => response.blob())
  .then((myBlob) => {
      var url = URL.createObjectURL(myBlob);
    flutterWebview.postMessage(JSON.stringify({feature:'blob', data:url}));    
  });    
      }
}
    

    
function test4() {
    if (window.flutterWebview != undefined) {
        var imageUrl = "https://kenshinn.github.io/Test/cast01.png";
        fetch(imageUrl)
            .then((response) => response.blob())
            .then(function(myBlob) {
                    var reader = new FileReader();

                    reader.onloadend = function() {
                        var base64String = reader.result;
                        flutterWebview.postMessage(JSON.stringify({
                            feature: 'blob',
                            data: base64String
                        }));
                    }
                    reader.readAsDataURL(myBlob);                
            });
    }
}  
      
  </script>
</head>

<body onload="window.setTimeout(onLoad, 200)">
  <input type="button" value="test" onclick="test()" />  
  <br />
  <input type="button" value="test blob" onclick="test4()" />  
  <br />
  <a href="intent:#Intent;action=android.intent.action.SEND;type=text/plain;S.android.intent.extra.TEXT=https%3A%2F%2Fwww.google.com%2F;end">test link</a>
  <br />
  <input type="file" />
<hr>
</body>
</html>
